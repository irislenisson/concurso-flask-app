<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscador de Concursos</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f0f2f5; }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { text-align: center; color: #333; }
        
        form { background: #fff; padding: 25px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: grid; gap: 15px; }
        
        label { font-weight: 600; color: #444; margin-bottom: 5px; display: block;}
        input, select { padding: 10px; border: 1px solid #ddd; border-radius: 5px; width: 100%; box-sizing: border-box; font-size: 16px; }
        
        input[type="submit"] { background-color: #007bff; color: #fff; border: none; cursor: pointer; font-weight: bold; padding: 12px; transition: background 0.3s; margin-top: 10px;}
        input[type="submit"]:hover { background-color: #0056b3; }
        
        #status-msg { margin: 20px 0; text-align: center; font-weight: bold; display: none; padding: 15px; border-radius: 5px;}
        .loading { color: #0056b3; background: #e7f1ff; }
        .empty { color: #856404; background: #fff3cd; }
        .error { color: #721c24; background: #f8d7da; }

        .concurso-card { background: #fff; margin-bottom: 15px; padding: 20px; border-left: 5px solid #28a745; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .concurso-card h3 { margin: 0 0 10px 0; font-size: 1.1em; color: #2c3e50; }
        
        .badges { display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap; }
        .badge { padding: 5px 10px; border-radius: 12px; font-size: 0.85em; font-weight: 600; }
        .badge.money { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .badge.uf { background-color: #cce5ff; color: #004085; border: 1px solid #b8daff; }
        .badge.date { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Buscador de Concursos</h1>

        <form id="searchForm">
            <div>
                <label>Sal√°rio M√≠nimo (R$):</label>
                <input type="number" id="salario_minimo" placeholder="Ex: 5000">
            </div>
            
            <div>
                <label>Palavra-chave:</label>
                <input type="text" id="palavra_chave" placeholder="Ex: Analista, Fiscal, TI">
            </div>

            <div>
                <label>UF (Estado):</label>
                <select id="uf">
                    <option value="">Todas as UFs</option>
                    <option value="AC">Acre (AC)</option>
                    <option value="AL">Alagoas (AL)</option>
                    <option value="AP">Amap√° (AP)</option>
                    <option value="AM">Amazonas (AM)</option>
                    <option value="BA">Bahia (BA)</option>
                    <option value="CE">Cear√° (CE)</option>
                    <option value="DF">Distrito Federal (DF)</option>
                    <option value="ES">Esp√≠rito Santo (ES)</option>
                    <option value="GO">Goi√°s (GO)</option>
                    <option value="MA">Maranh√£o (MA)</option>
                    <option value="MT">Mato Grosso (MT)</option>
                    <option value="MS">Mato Grosso do Sul (MS)</option>
                    <option value="MG">Minas Gerais (MG)</option>
                    <option value="PA">Par√° (PA)</option>
                    <option value="PB">Para√≠ba (PB)</option>
                    <option value="PR">Paran√° (PR)</option>
                    <option value="PE">Pernambuco (PE)</option>
                    <option value="PI">Piau√≠ (PI)</option>
                    <option value="RJ">Rio de Janeiro (RJ)</option>
                    <option value="RN">Rio Grande do Norte (RN)</option>
                    <option value="RS">Rio Grande do Sul (RS)</option>
                    <option value="RO">Rond√¥nia (RO)</option>
                    <option value="RR">Roraima (RR)</option>
                    <option value="SC">Santa Catarina (SC)</option>
                    <option value="SP">S√£o Paulo (SP)</option>
                    <option value="SE">Sergipe (SE)</option>
                    <option value="TO">Tocantins (TO)</option>
                </select>
            </div>

            <div>
                <label>Excluir palavras:</label>
                <input type="text" id="excluir_palavra" placeholder="Ex: m√©dico, professor">
            </div>

            <input type="submit" value="üîç Filtrar Concursos">
        </form>

        <div id="status-msg"></div>
        <div id="resultados-container"></div>
    </div>

    <script>
        document.getElementById('searchForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const statusDiv = document.getElementById('status-msg');
            const container = document.getElementById('resultados-container');
            
            container.innerHTML = '';
            statusDiv.className = 'loading';
            statusDiv.innerText = '‚è≥ Buscando e ordenando melhores sal√°rios...';
            statusDiv.style.display = 'block';

            const payload = {
                salario_minimo: document.getElementById('salario_minimo').value,
                palavra_chave: document.getElementById('palavra_chave').value,
                excluir_palavra: document.getElementById('excluir_palavra').value,
                uf: document.getElementById('uf').value
            };

            try {
                const response = await fetch('/api/buscar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`Erro: ${response.status}`);

                const concursos = await response.json();

                if (concursos.length === 0) {
                    statusDiv.className = 'empty';
                    statusDiv.innerHTML = '‚ö†Ô∏è Nenhum concurso encontrado com esses filtros.';
                    return;
                }

                statusDiv.style.display = 'none';

                // Cria os cards (j√° vir√£o ordenados do Python)
                concursos.forEach(c => {
                    const div = document.createElement('div');
                    div.className = 'concurso-card';
                    div.innerHTML = `
                        <h3>${c['Informa√ß√µes do Concurso']}</h3>
                        <div class="badges">
                            <span class="badge money">üí∞ ${c['Sal√°rio']}</span>
                            <span class="badge uf">üìç ${c['UF']}</span>
                            <span class="badge date">üìÖ At√©: ${c['Data Fim Inscri√ß√£o']}</span>
                        </div>
                    `;
                    container.appendChild(div);
                });

            } catch (error) {
                console.error(error);
                statusDiv.className = 'error';
                statusDiv.innerHTML = `‚ùå Erro na busca. Tente novamente.`;
            }
        });
    </script>
</body>
</html>