<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscador de Concursos</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f0f2f5; }
        h1 { color: #1a1a1a; text-align: center; }
        .container { max-width: 800px; margin: 0 auto; }
        form { background: #fff; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: grid; gap: 15px; }
        label { font-weight: 600; color: #444; }
        input, select { padding: 10px; border: 1px solid #ddd; border-radius: 5px; width: 100%; box-sizing: border-box; font-size: 16px; }
        input[type="submit"] { background-color: #007bff; color: #fff; border: none; cursor: pointer; font-weight: bold; padding: 12px; transition: background 0.3s; }
        input[type="submit"]:hover { background-color: #0056b3; }
        
        #status-msg { margin: 20px 0; text-align: center; font-weight: bold; display: none; padding: 10px; border-radius: 5px;}
        .loading { color: #0056b3; background: #e7f1ff; }
        .error { color: #721c24; background: #f8d7da; }
        .empty { color: #856404; background: #fff3cd; }

        .concurso-card { background: #fff; margin-bottom: 15px; padding: 20px; border-left: 5px solid #007bff; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .concurso-card h3 { margin: 0 0 10px 0; font-size: 1.1em; color: #333; }
        .badges { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .badge { background: #e9ecef; padding: 5px 10px; border-radius: 15px; font-size: 0.9em; font-weight: 600; color: #495057; }
        .badge.money { background: #d4edda; color: #155724; }
        .badge.date { background: #fff3cd; color: #856404; }
    </style>
</head>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4697233336143262"
     crossorigin="anonymous"></script>
<body>
    <div class="container">
        <h1>üöÄ Buscador de Concursos</h1>

        <form id="searchForm">
            <div>
                <label>Sal√°rio M√≠nimo (R$):</label>
                <input type="number" id="salario_minimo" placeholder="Ex: 3000 (Deixe vazio para ver todos)">
            </div>
            
            <div>
                <label>Palavra-chave:</label>
                <input type="text" id="palavra_chave" placeholder="Ex: Analista, Prefeitura, TI">
            </div>

            <div>
                <label>UF:</label>
                <select id="uf">
                    <option value="">Todas as UFs</option>
                    <option value="SP">SP</option> <option value="RJ">RJ</option> <option value="MG">MG</option>
                    <option value="DF">DF</option> <option value="RS">RS</option> <option value="PR">PR</option>
                    <option value="SC">SC</option> <option value="BA">BA</option> <option value="PE">PE</option>
                </select>
            </div>

            <div>
                <label>Excluir palavras:</label>
                <input type="text" id="excluir_palavra" placeholder="Ex: est√°gio, fundamental">
            </div>

            <input type="submit" value="üîç Buscar Concursos">
        </form>

        <div id="status-msg"></div>
        <div id="resultados-container"></div>
    </div>

    <script>
        document.getElementById('searchForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const statusDiv = document.getElementById('status-msg');
            const container = document.getElementById('resultados-container');
            
            // Limpa tela e mostra loading
            container.innerHTML = '';
            statusDiv.className = 'loading';
            statusDiv.innerText = '‚è≥ Conectando ao servidor e buscando dados... (Isso pode levar at√© 30s se o servidor estiver acordando)';
            statusDiv.style.display = 'block';

            const payload = {
                salario_minimo: document.getElementById('salario_minimo').value,
                palavra_chave: document.getElementById('palavra_chave').value,
                excluir_palavra: document.getElementById('excluir_palavra').value,
                uf: document.getElementById('uf').value
            };

            try {
                const response = await fetch('/api/buscar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`Erro do Servidor: ${response.status}`);

                const concursos = await response.json();

                if (concursos.length === 0) {
                    statusDiv.className = 'empty';
                    statusDiv.innerHTML = '‚ö†Ô∏è Nenhum concurso encontrado.<br>Tente diminuir o sal√°rio m√≠nimo ou remover palavras-chave.';
                    return;
                }

                statusDiv.style.display = 'none';

                concursos.forEach(c => {
                    const div = document.createElement('div');
                    div.className = 'concurso-card';
                    div.innerHTML = `
                        <h3>${c['Informa√ß√µes do Concurso']}</h3>
                        <div class="badges">
                            <span class="badge money">üí∞ ${c['Sal√°rio']}</span>
                            <span class="badge">üìç ${c['UF']}</span>
                            <span class="badge date">üìÖ At√©: ${c['Data Fim Inscri√ß√£o']}</span>
                        </div>
                    `;
                    container.appendChild(div);
                });

            } catch (error) {
                console.error(error);
                statusDiv.className = 'error';
                statusDiv.innerHTML = `‚ùå Falha na busca.<br>Erro t√©cnico: ${error.message}`;
            }
        });
    </script>
</body>
</html>