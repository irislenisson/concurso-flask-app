{% extends "base.html" %}

{% block head_extra %}
    {% if schema_jobs %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "itemListElement": [
        {% for job in schema_jobs %}
        {
          "@type": "ListItem",
          "position": {{ loop.index }},
          "item": {
            "@type": "JobPosting",
            "title": "{{ job.titulo }}",
            "description": "Concurso P√∫blico: {{ job.titulo }}. Local: {{ job.local }}. Confira edital.",
            "datePosted": "{{ job.data_postagem }}",
            {% if job.validade %}"validThrough": "{{ job.validade }}",{% endif %}
            "jobLocation": { "@type": "Place", "address": { "@type": "PostalAddress", "addressRegion": "{{ job.local }}", "addressCountry": "BR" } },
            "baseSalary": { "@type": "MonetaryAmount", "currency": "BRL", "value": { "@type": "QuantitativeValue", "value": {{ job.salario }}, "unitText": "MONTH" } },
            "url": "{{ job.url }}"
          }
        }{{ "," if not loop.last }}
        {% endfor %}
      ]
    }
    </script>
    {% endif %}
{% endblock %}

{% block title %}CONCURSO IDEAL | Vagas Abertas 2025{% endblock %}

{% block content %}
    <div id="favorites-view" style="display: none;">
        <div class="fav-header-title" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:2px solid var(--border-color); padding-bottom:10px;">
            <h2 style="margin:0; color: var(--primary-color);">‚ù§Ô∏è Vagas Salvas</h2>
            <button onclick="toggleTelaFavoritos()" style="background:none; border:none; font-size:1.5em; cursor:pointer; color:var(--text-secondary);">&times;</button>
        </div>
        <div id="favorites-list-container"></div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="toggleTelaFavoritos()" class="action-btn" style="background: var(--text-secondary); color: white;">Voltar</button>
        </div>
    </div>

    <div id="main-view">
        <form id="searchForm">
            <div class="form-cols">
                <div>
                    <label>üí∞ Sal√°rio Inicial</label>
                    <input type="tel" id="salario_minimo" placeholder="R$ 0,00" oninput="formatarMoeda(this)">
                </div>
                <div>
                    <label>üîç Palavra-chave</label>
                    <input type="text" id="palavra_chave" placeholder="Ex: TI, Fiscal, Analista">
                </div>
            </div>

            <div style="margin-top: 15px;">
                <label>üéì Escolaridade</label>
                <div class="btn-grid">
                    <div class="filter-btn level-btn" data-value="fundamental">Fundamental</div>
                    <div class="filter-btn level-btn" data-value="medio">M√©dio / T√©cnico</div>
                    <div class="filter-btn level-btn" data-value="superior">Superior</div>
                </div>
            </div>

            <div class="section-divider"></div>

            <div>
                <label>üåé Regi√µes</label>
                <div class="btn-grid">
                    <div class="filter-btn region-btn" data-value="Nacional">Nacional</div>
                    <div class="filter-btn region-btn" data-value="Norte">Norte</div>
                    <div class="filter-btn region-btn" data-value="Nordeste">Nordeste</div>
                    <div class="filter-btn region-btn" data-value="Centro-Oeste">Centro-Oeste</div>
                    <div class="filter-btn region-btn" data-value="Sudeste">Sudeste</div>
                    <div class="filter-btn region-btn" data-value="Sul">Sul</div>
                </div>
            </div>

            <div>
                <label>üìç Estados</label>
                <div class="uf-grid">
                    <div class="uf-btn" data-value="AC">AC</div> <div class="uf-btn" data-value="AL">AL</div>
                    <div class="uf-btn" data-value="AP">AP</div> <div class="uf-btn" data-value="AM">AM</div>
                    <div class="uf-btn" data-value="BA">BA</div> <div class="uf-btn" data-value="CE">CE</div>
                    <div class="uf-btn" data-value="DF">DF</div> <div class="uf-btn" data-value="ES">ES</div>
                    <div class="uf-btn" data-value="GO">GO</div> <div class="uf-btn" data-value="MA">MA</div>
                    <div class="uf-btn" data-value="MT">MT</div> <div class="uf-btn" data-value="MS">MS</div>
                    <div class="uf-btn" data-value="MG">MG</div> <div class="uf-btn" data-value="PA">PA</div>
                    <div class="uf-btn" data-value="PB">PB</div> <div class="uf-btn" data-value="PR">PR</div>
                    <div class="uf-btn" data-value="PE">PE</div> <div class="uf-btn" data-value="PI">PI</div>
                    <div class="uf-btn" data-value="RJ">RJ</div> <div class="uf-btn" data-value="RN">RN</div>
                    <div class="uf-btn" data-value="RS">RS</div> <div class="uf-btn" data-value="RO">RO</div>
                    <div class="uf-btn" data-value="RR">RR</div> <div class="uf-btn" data-value="SC">SC</div>
                    <div class="uf-btn" data-value="SP">SP</div> <div class="uf-btn" data-value="SE">SE</div>
                    <div class="uf-btn" data-value="TO">TO</div>
                </div>
            </div>

            <div class="section-divider"></div>

            <div>
                <label>üö´ Excluir palavras</label>
                <input type="text" id="excluir_palavra" placeholder="Ex: fundamental, est√°gio">
            </div>

            <div class="search-grid">
                <input type="submit" id="btn-buscar" value="Buscar Oportunidades">
                <button type="button" class="btn-clear" onclick="limparFiltros()">
                    <i class="fas fa-eraser"></i> LIMPAR
                </button>
            </div>
            
            <div class="share-row">
                 <button type="button" class="share-btn" onclick="compartilharNativo()" style="width: 100%; justify-content: center; padding: 10px;">
                    <i class="fas fa-share-alt"></i> Compartilhar com Amigos
                </button>
            </div>
        </form>

        <div class="newsletter-box">
            <div class="news-icon">üîî</div>
            <div class="news-text">
                <h3>Seja avisado primeiro!</h3>
                <p>Receba os editais no seu e-mail.</p>
            </div>
            <div class="news-form">
                <input type="email" id="email-lead" placeholder="Seu e-mail...">
                <button onclick="cadastrarLead()">Cadastrar</button>
            </div>
        </div>

        <div id="status-msg"></div>
        <div id="resultados-container"></div>
        <button id="btn-load-more" onclick="carregarMais()">üëá Carregar mais resultados</button>
    </div>

    <button id="btn-back-to-top" onclick="scrollToTop()"><i class="fas fa-arrow-up"></i></button>
    <div id="toast">Copiado!</div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const btnGlobal = document.getElementById('btn-fav-global');
            if(btnGlobal) btnGlobal.style.display = 'flex';
        });
    </script>
{% endblock %}